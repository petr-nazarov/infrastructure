# services:
  gotify:
    image: gotify/server:latest
    networks:
      - local_net
    # dns:
    #   - "{{ local_dns }}"
    environment:
      GOTIFY_DEFAULTUSER_PASS: "{{ admin_pass }}"
      TZ: "{{ tz }}"
    volumes:
      - "{{ remote_data }}/gotify:/app/data"
    deploy:
      replicas: 1
      placement:
        constraints:
          - "node.role == manager"
      labels:
        - "traefik.enable=true"
        # Traefik Routing
        - "traefik.http.routers.gotify.rule=Host(`ntf.{{ public_top_domain }}`)"
        - "traefik.http.routers.gotify.entrypoints=websecure"
        - "traefik.http.routers.gotify.tls=true"
        - "traefik.http.services.gotify.loadbalancer.server.port=80"
        - "traefik.http.routers.gotify.middlewares=force-https@file"
